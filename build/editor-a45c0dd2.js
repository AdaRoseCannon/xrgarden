import{Z as e,c as t,at as n,V as o,Q as i,e as a,u as s,t as r,au as l,av as c,x as h,aw as p,H as d,ax as u,ay as w,az as m,al as y,aA as v,_ as b,C as f,aB as g,a as M,ar as x,J as P}from"./three-b385e992.js";import{c as X,s as E,m as Y,r as Z,a as S,w as I,b as j,d as z}from"./garden-68d7c3ed.js";var Q=function(t,a){void 0===a&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),a=document),e.call(this),this.visible=!1,this.domElement=a;var s=new A;this.add(s);var r=new k;this.add(r);var l=this;N("camera",t),N("object",void 0),N("enabled",!0),N("axis",null),N("mode","translate"),N("translationSnap",null),N("rotationSnap",null),N("scaleSnap",null),N("space","world"),N("size",1),N("dragging",!1),N("showX",!0),N("showY",!0),N("showZ",!0);var c={type:"change"},h={type:"mouseDown"},p={type:"mouseUp",mode:l.mode},d={type:"objectChange"},u=new n;function w(e,t,n){for(var o=t.intersectObject(e,!0),i=0;i<o.length;i++)if(o[i].object.visible||n)return o[i];return!1}var m=new o,y=new o,v=new i,b={X:new o(1,0,0),Y:new o(0,1,0),Z:new o(0,0,1)},f=new o,g=new o,M=new o,x=new o,P=new o,X=new o,E=0,Y=new o,Z=new i,S=new o,I=new o,j=new i,z=new i,Q=new o,T=new o,L=new i,q=new o,O=new o,F=new i,C=new i,W=new o,D=new o,H=new o,R=new i,_=new o;function N(e,t){var n=t;Object.defineProperty(l,e,{get:function(){return void 0!==n?n:t},set:function(t){n!==t&&(n=t,r[e]=t,s[e]=t,l.dispatchEvent({type:e+"-changed",value:t}),l.dispatchEvent(c))}}),l[e]=t,r[e]=t,s[e]=t}function U(e){if(l.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};var t=e.changedTouches?e.changedTouches[0]:e,n=a.getBoundingClientRect();return{x:(t.clientX-n.left)/n.width*2-1,y:-(t.clientY-n.top)/n.height*2+1,button:e.button}}function B(e){if(l.enabled)switch(e.pointerType){case"mouse":case"pen":l.pointerHover(U(e))}}function G(e){l.enabled&&(l.domElement.style.touchAction="none",l.domElement.ownerDocument.addEventListener("pointermove",J,!1),l.pointerHover(U(e)),l.pointerDown(U(e)))}function J(e){l.enabled&&l.pointerMove(U(e))}function V(e){l.enabled&&(l.domElement.style.touchAction="",l.domElement.ownerDocument.removeEventListener("pointermove",J,!1),l.pointerUp(U(e)))}N("worldPosition",O),N("worldPositionStart",T),N("worldQuaternion",F),N("worldQuaternionStart",L),N("cameraPosition",Y),N("cameraQuaternion",Z),N("pointStart",f),N("pointEnd",g),N("rotationAxis",x),N("rotationAngle",E),N("eye",D),a.addEventListener("pointerdown",G,!1),a.addEventListener("pointermove",B,!1),l.domElement.ownerDocument.addEventListener("pointerup",V,!1),this.dispose=function(){a.removeEventListener("pointerdown",G),a.removeEventListener("pointermove",B),l.domElement.ownerDocument.removeEventListener("pointermove",J),l.domElement.ownerDocument.removeEventListener("pointerup",V),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))},this.attach=function(e){return this.object=e,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(I,j,Q),this.object.matrixWorld.decompose(O,F,W),z.copy(j).inverse(),C.copy(F).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(Y,Z,S),D.copy(Y).sub(O).normalize(),e.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(e){if(void 0!==this.object&&!0!==this.dragging){u.setFromCamera(e,this.camera);var t=w(s.picker[this.mode],u);this.axis=t?t.object.name:null}},this.pointerDown=function(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){u.setFromCamera(e,this.camera);var t=w(r,u,!0);if(t){var n=this.space;if("scale"===this.mode?n="local":"E"!==this.axis&&"XYZE"!==this.axis&&"XYZ"!==this.axis||(n="world"),"local"===n&&"rotate"===this.mode){var o=this.rotationSnap;"X"===this.axis&&o&&(this.object.rotation.x=Math.round(this.object.rotation.x/o)*o),"Y"===this.axis&&o&&(this.object.rotation.y=Math.round(this.object.rotation.y/o)*o),"Z"===this.axis&&o&&(this.object.rotation.z=Math.round(this.object.rotation.z/o)*o)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),H.copy(this.object.position),R.copy(this.object.quaternion),_.copy(this.object.scale),this.object.matrixWorld.decompose(T,L,q),f.copy(t.point).sub(T)}this.dragging=!0,h.mode=this.mode,this.dispatchEvent(h)}},this.pointerMove=function(e){var t=this.axis,n=this.mode,o=this.object,i=this.space;if("scale"===n?i="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(i="world"),void 0!==o&&null!==t&&!1!==this.dragging&&-1===e.button){u.setFromCamera(e,this.camera);var a=w(r,u,!0);if(a){if(g.copy(a.point).sub(T),"translate"===n)M.copy(g).sub(f),"local"===i&&"XYZ"!==t&&M.applyQuaternion(C),-1===t.indexOf("X")&&(M.x=0),-1===t.indexOf("Y")&&(M.y=0),-1===t.indexOf("Z")&&(M.z=0),"local"===i&&"XYZ"!==t?M.applyQuaternion(R).divide(Q):M.applyQuaternion(z).divide(Q),o.position.copy(M).add(H),this.translationSnap&&("local"===i&&(o.position.applyQuaternion(v.copy(R).inverse()),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.position.applyQuaternion(R)),"world"===i&&(o.parent&&o.position.add(m.setFromMatrixPosition(o.parent.matrixWorld)),-1!==t.search("X")&&(o.position.x=Math.round(o.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(o.position.y=Math.round(o.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(o.position.z=Math.round(o.position.z/this.translationSnap)*this.translationSnap),o.parent&&o.position.sub(m.setFromMatrixPosition(o.parent.matrixWorld))));else if("scale"===n){if(-1!==t.search("XYZ")){var s=g.length()/f.length();g.dot(f)<0&&(s*=-1),y.set(s,s,s)}else m.copy(f),y.copy(g),m.applyQuaternion(C),y.applyQuaternion(C),y.divide(m),-1===t.search("X")&&(y.x=1),-1===t.search("Y")&&(y.y=1),-1===t.search("Z")&&(y.z=1);o.scale.copy(_).multiply(y),this.scaleSnap&&(-1!==t.search("X")&&(o.scale.x=Math.round(o.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(o.scale.y=Math.round(o.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(o.scale.z=Math.round(o.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===n){M.copy(g).sub(f);var l=20/O.distanceTo(m.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(x.copy(D),E=g.angleTo(f),P.copy(f).normalize(),X.copy(g).normalize(),E*=X.cross(P).dot(D)<0?1:-1):"XYZE"===t?(x.copy(M).cross(D).normalize(),E=M.dot(m.copy(x).cross(this.eye))*l):"X"!==t&&"Y"!==t&&"Z"!==t||(x.copy(b[t]),m.copy(b[t]),"local"===i&&m.applyQuaternion(F),E=M.dot(m.cross(D).normalize())*l),this.rotationSnap&&(E=Math.round(E/this.rotationSnap)*this.rotationSnap),this.rotationAngle=E,"local"===i&&"E"!==t&&"XYZE"!==t?(o.quaternion.copy(R),o.quaternion.multiply(v.setFromAxisAngle(x,E)).normalize()):(x.applyQuaternion(z),o.quaternion.copy(v.setFromAxisAngle(x,E)),o.quaternion.multiply(R).normalize())}this.dispatchEvent(c),this.dispatchEvent(d)}}},this.pointerUp=function(e){0===e.button&&(this.dragging&&null!==this.axis&&(p.mode=this.mode,this.dispatchEvent(p)),this.dragging=!1,this.axis=null)},this.getMode=function(){return l.mode},this.setMode=function(e){l.mode=e},this.setTranslationSnap=function(e){l.translationSnap=e},this.setRotationSnap=function(e){l.rotationSnap=e},this.setScaleSnap=function(e){l.scaleSnap=e},this.setSize=function(e){l.size=e},this.setSpace=function(e){l.space=e},this.update=function(){console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}};Q.prototype=Object.assign(Object.create(e.prototype),{constructor:Q,isTransformControls:!0});var A=function(){e.call(this),this.type="TransformControlsGizmo";var n=new a({depthTest:!1,depthWrite:!1,transparent:!0,side:s,fog:!1,toneMapped:!1}),g=new r({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),M=n.clone();M.opacity=.15;var x=n.clone();x.opacity=.33;var P=n.clone();P.color.set(16711680);var X=n.clone();X.color.set(65280);var E=n.clone();E.color.set(255);var Y=n.clone();Y.opacity=.25;var Z=Y.clone();Z.color.set(16776960);var S=Y.clone();S.color.set(65535);var I=Y.clone();I.color.set(16711935),n.clone().color.set(16776960);var j=g.clone();j.color.set(16711680);var z=g.clone();z.color.set(65280);var Q=g.clone();Q.color.set(255);var A=g.clone();A.color.set(65535);var k=g.clone();k.color.set(16711935);var T=g.clone();T.color.set(16776960);var L=g.clone();L.color.set(7895160);var q=T.clone();q.opacity=.25;var O=new l(0,.05,.2,12,1,!1),F=new c(.125,.125,.125),C=new h;C.setAttribute("position",new p([0,0,0,1,0,0],3));var W,D=function(e,t){for(var n=new h,o=[],i=0;i<=64*t;++i)o.push(0,Math.cos(i/32*Math.PI)*e,Math.sin(i/32*Math.PI)*e);return n.setAttribute("position",new p(o,3)),n},H={X:[[new t(O,P),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new t(O,P),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new d(C,j)]],Y:[[new t(O,X),[0,1,0],null,null,"fwd"],[new t(O,X),[0,1,0],[Math.PI,0,0],null,"bwd"],[new d(C,z),null,[0,0,Math.PI/2]]],Z:[[new t(O,E),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new t(O,E),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new d(C,Q),null,[0,-Math.PI/2,0]]],XYZ:[[new t(new u(.1,0),Y.clone()),[0,0,0],[0,0,0]]],XY:[[new t(new w(.295,.295),Z.clone()),[.15,.15,0]],[new d(C,T),[.18,.3,0],null,[.125,1,1]],[new d(C,T),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new t(new w(.295,.295),S.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new d(C,A),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new d(C,A),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new t(new w(.295,.295),I.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new d(C,k),[.18,0,.3],null,[.125,1,1]],[new d(C,k),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},R={X:[[new t(new l(.2,0,1,4,1,!1),M),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new t(new l(.2,0,1,4,1,!1),M),[0,.6,0]]],Z:[[new t(new l(.2,0,1,4,1,!1),M),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new t(new u(.2,0),M)]],XY:[[new t(new w(.4,.4),M),[.2,.2,0]]],YZ:[[new t(new w(.4,.4),M),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new t(new w(.4,.4),M),[.2,0,.2],[-Math.PI/2,0,0]]]},_={START:[[new t(new u(.01,2),x),null,null,null,"helper"]],END:[[new t(new u(.01,2),x),null,null,null,"helper"]],DELTA:[[new d((W=new h,W.setAttribute("position",new p([0,0,0,1,1,1],3)),W),x),null,null,null,"helper"]],X:[[new d(C,x.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new d(C,x.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new d(C,x.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},N={X:[[new d(D(1,.5),j)],[new t(new u(.04,0),P),[0,0,.99],null,[1,3,1]]],Y:[[new d(D(1,.5),z),null,[0,0,-Math.PI/2]],[new t(new u(.04,0),X),[0,0,.99],null,[3,1,1]]],Z:[[new d(D(1,.5),Q),null,[0,Math.PI/2,0]],[new t(new u(.04,0),E),[.99,0,0],null,[1,3,1]]],E:[[new d(D(1.25,1),q),null,[0,Math.PI/2,0]],[new t(new l(.03,0,.15,4,1,!1),q),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new t(new l(.03,0,.15,4,1,!1),q),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new t(new l(.03,0,.15,4,1,!1),q),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new t(new l(.03,0,.15,4,1,!1),q),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new d(D(1,1),L),null,[0,Math.PI/2,0]]]},U={AXIS:[[new d(C,x.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},B={X:[[new t(new m(1,.1,4,24),M),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new t(new m(1,.1,4,24),M),[0,0,0],[Math.PI/2,0,0]]],Z:[[new t(new m(1,.1,4,24),M),[0,0,0],[0,0,-Math.PI/2]]],E:[[new t(new m(1.25,.1,2,24),M)]],XYZE:[[new t(new y(.7,10,8),M)]]},G={X:[[new t(F,P),[.8,0,0],[0,0,-Math.PI/2]],[new d(C,j),null,null,[.8,1,1]]],Y:[[new t(F,X),[0,.8,0]],[new d(C,z),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new t(F,E),[0,0,.8],[Math.PI/2,0,0]],[new d(C,Q),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new t(F,Z),[.85,.85,0],null,[2,2,.2]],[new d(C,T),[.855,.98,0],null,[.125,1,1]],[new d(C,T),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new t(F,S),[0,.85,.85],null,[.2,2,2]],[new d(C,A),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new d(C,A),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new t(F,I),[.85,0,.85],null,[2,.2,2]],[new d(C,k),[.855,0,.98],null,[.125,1,1]],[new d(C,k),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new t(new c(.125,.125,.125),Y.clone()),[1.1,0,0]]],XYZY:[[new t(new c(.125,.125,.125),Y.clone()),[0,1.1,0]]],XYZZ:[[new t(new c(.125,.125,.125),Y.clone()),[0,0,1.1]]]},J={X:[[new t(new l(.2,0,.8,4,1,!1),M),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new t(new l(.2,0,.8,4,1,!1),M),[0,.5,0]]],Z:[[new t(new l(.2,0,.8,4,1,!1),M),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new t(F,M),[.85,.85,0],null,[3,3,.2]]],YZ:[[new t(F,M),[0,.85,.85],null,[.2,3,3]]],XZ:[[new t(F,M),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new t(new c(.2,.2,.2),M),[1.1,0,0]]],XYZY:[[new t(new c(.2,.2,.2),M),[0,1.1,0]]],XYZZ:[[new t(new c(.2,.2,.2),M),[0,0,1.1]]]},V={X:[[new d(C,x.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new d(C,x.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new d(C,x.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},K=function(t){var n=new e;for(var o in t)for(var i=t[o].length;i--;){var a=t[o][i][0].clone(),s=t[o][i][1],r=t[o][i][2],l=t[o][i][3],c=t[o][i][4];a.name=o,a.tag=c,s&&a.position.set(s[0],s[1],s[2]),r&&a.rotation.set(r[0],r[1],r[2]),l&&a.scale.set(l[0],l[1],l[2]),a.updateMatrix();var h=a.geometry.clone();h.applyMatrix4(a.matrix),a.geometry=h,a.renderOrder=1/0,a.position.set(0,0,0),a.rotation.set(0,0,0),a.scale.set(1,1,1),n.add(a)}return n},$=new o(0,0,0),ee=new v,te=new o(0,1,0),ne=new o(0,0,0),oe=new b,ie=new i,ae=new i,se=new i,re=new o(1,0,0),le=new o(0,1,0),ce=new o(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=K(H)),this.add(this.gizmo.rotate=K(N)),this.add(this.gizmo.scale=K(G)),this.add(this.picker.translate=K(R)),this.add(this.picker.rotate=K(B)),this.add(this.picker.scale=K(J)),this.add(this.helper.translate=K(_)),this.add(this.helper.rotate=K(U)),this.add(this.helper.scale=K(V)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var t=this.space;"scale"===this.mode&&(t="local");var n="local"===t?this.worldQuaternion:se;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var o=[];o=(o=(o=o.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var i=0;i<o.length;i++){var a,s=o[i];if(s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition),a=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(a*this.size/7),"helper"!==s.tag){if(s.quaternion.copy(n),"translate"===this.mode||"scale"===this.mode){var r=.99;"X"!==s.name&&"XYZX"!==s.name||Math.abs(te.copy(re).applyQuaternion(n).dot(this.eye))>r&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Y"!==s.name&&"XYZY"!==s.name||Math.abs(te.copy(le).applyQuaternion(n).dot(this.eye))>r&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Z"!==s.name&&"XYZZ"!==s.name||Math.abs(te.copy(ce).applyQuaternion(n).dot(this.eye))>r&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XY"===s.name&&Math.abs(te.copy(ce).applyQuaternion(n).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"YZ"===s.name&&Math.abs(te.copy(re).applyQuaternion(n).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XZ"===s.name&&Math.abs(te.copy(le).applyQuaternion(n).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),-1!==s.name.search("X")&&(te.copy(re).applyQuaternion(n).dot(this.eye)<0?"fwd"===s.tag?s.visible=!1:s.scale.x*=-1:"bwd"===s.tag&&(s.visible=!1)),-1!==s.name.search("Y")&&(te.copy(le).applyQuaternion(n).dot(this.eye)<0?"fwd"===s.tag?s.visible=!1:s.scale.y*=-1:"bwd"===s.tag&&(s.visible=!1)),-1!==s.name.search("Z")&&(te.copy(ce).applyQuaternion(n).dot(this.eye)<0?"fwd"===s.tag?s.visible=!1:s.scale.z*=-1:"bwd"===s.tag&&(s.visible=!1))}else"rotate"===this.mode&&(ae.copy(n),te.copy(this.eye).applyQuaternion(ie.copy(n).inverse()),-1!==s.name.search("E")&&s.quaternion.setFromRotationMatrix(oe.lookAt(this.eye,ne,le)),"X"===s.name&&(ie.setFromAxisAngle(re,Math.atan2(-te.y,te.z)),ie.multiplyQuaternions(ae,ie),s.quaternion.copy(ie)),"Y"===s.name&&(ie.setFromAxisAngle(le,Math.atan2(te.x,te.z)),ie.multiplyQuaternions(ae,ie),s.quaternion.copy(ie)),"Z"===s.name&&(ie.setFromAxisAngle(ce,Math.atan2(te.y,te.x)),ie.multiplyQuaternions(ae,ie),s.quaternion.copy(ie)));s.visible=s.visible&&(-1===s.name.indexOf("X")||this.showX),s.visible=s.visible&&(-1===s.name.indexOf("Y")||this.showY),s.visible=s.visible&&(-1===s.name.indexOf("Z")||this.showZ),s.visible=s.visible&&(-1===s.name.indexOf("E")||this.showX&&this.showY&&this.showZ),s.material._opacity=s.material._opacity||s.material.opacity,s.material._color=s.material._color||s.material.color.clone(),s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled?this.axis&&(s.name===this.axis||this.axis.split("").some((function(e){return s.name===e}))?(s.material.opacity=1,s.material.color.lerp(new f(1,1,1),.5)):(s.material.opacity*=.25,s.material.color.lerp(new f(1,1,1),.5))):(s.material.opacity*=.5,s.material.color.lerp(new f(1,1,1),.5))}else s.visible=!1,"AXIS"===s.name?(s.position.copy(this.worldPositionStart),s.visible=!!this.axis,"X"===this.axis&&(ie.setFromEuler(ee.set(0,0,0)),s.quaternion.copy(n).multiply(ie),Math.abs(te.copy(re).applyQuaternion(n).dot(this.eye))>.9&&(s.visible=!1)),"Y"===this.axis&&(ie.setFromEuler(ee.set(0,0,Math.PI/2)),s.quaternion.copy(n).multiply(ie),Math.abs(te.copy(le).applyQuaternion(n).dot(this.eye))>.9&&(s.visible=!1)),"Z"===this.axis&&(ie.setFromEuler(ee.set(0,Math.PI/2,0)),s.quaternion.copy(n).multiply(ie),Math.abs(te.copy(ce).applyQuaternion(n).dot(this.eye))>.9&&(s.visible=!1)),"XYZE"===this.axis&&(ie.setFromEuler(ee.set(0,Math.PI/2,0)),te.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(oe.lookAt(ne,te,le)),s.quaternion.multiply(ie),s.visible=this.dragging),"E"===this.axis&&(s.visible=!1)):"START"===s.name?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):"END"===s.name?(s.position.copy(this.worldPosition),s.visible=this.dragging):"DELTA"===s.name?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),$.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),$.applyQuaternion(this.worldQuaternionStart.clone().inverse()),s.scale.copy($),s.visible=this.dragging):(s.quaternion.copy(n),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=-1!==this.axis.search(s.name)))}e.prototype.updateMatrixWorld.call(this)}};A.prototype=Object.assign(Object.create(e.prototype),{constructor:A,isTransformControlsGizmo:!0});var k=function(){t.call(this,new w(1e5,1e5,2,2),new a({visible:!1,wireframe:!0,side:s,transparent:!0,opacity:.1,toneMapped:!1})),this.type="TransformControlsPlane";var n=new o(1,0,0),r=new o(0,1,0),l=new o(0,0,1),c=new o,h=new o,p=new o,d=new b,u=new i;this.updateMatrixWorld=function(){var t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),n.set(1,0,0).applyQuaternion("local"===t?this.worldQuaternion:u),r.set(0,1,0).applyQuaternion("local"===t?this.worldQuaternion:u),l.set(0,0,1).applyQuaternion("local"===t?this.worldQuaternion:u),p.copy(r),this.mode){case"translate":case"scale":switch(this.axis){case"X":p.copy(this.eye).cross(n),h.copy(n).cross(p);break;case"Y":p.copy(this.eye).cross(r),h.copy(r).cross(p);break;case"Z":p.copy(this.eye).cross(l),h.copy(l).cross(p);break;case"XY":h.copy(l);break;case"YZ":h.copy(n);break;case"XZ":p.copy(l),h.copy(r);break;case"XYZ":case"E":h.set(0,0,0)}break;case"rotate":default:h.set(0,0,0)}0===h.length()?this.quaternion.copy(this.cameraQuaternion):(d.lookAt(c.set(0,0,0),h,p),this.quaternion.setFromRotationMatrix(d)),e.prototype.updateMatrixWorld.call(this)}};k.prototype=Object.assign(Object.create(t.prototype),{constructor:k,isTransformControlsPlane:!0});let T="none";const L=[],q=[],O=[];let F,C,W=!1,D=[];const H=[],R=new g(.1,.1,.1),_=new a(10092441),N={item1:L,item2:q,curve:H};const U=new n,B=new M,G=function(){const e=new Q(S,j.domElement);return e.addEventListener("dragging-changed",(function(t){e.object.curve&&e.object.curve.redraw(),z.enabled=!t.value})),e}();function J(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function V(e){const n=[];for(const o of e){const e=new t(R,_);H.push(e),n.push(e),E.add(e),e.position.copy(o)}const o=new x(n.map((e=>e.position)));o.curveType="centripetal",o.closed=!0,O.push(o);const i=o.getPoints(50),a=new P((new h).setFromPoints(i),new r({color:65280}));o.redraw=function(){const e=o.getPoints(50);a.geometry.setFromPoints(e)},o.line=a;for(const e of n)e.curve=o,e.remove=function(){o.points.length>1?J(o.points,e.position):(E.remove(o.line),J(O,o))};return E.add(a),{curve:o,handles:n}}function K(e){window.overlay.querySelector('[value="curve"]').click();const n=new t(R,_);H.push(n),E.add(n);const o=F,i=C;e?n.position.copy(e):(n.position.copy(i.position),n.position.x+=1.4*(Math.random()-.5),n.position.z+=1.4*(Math.random()-.5)),n.curve=o,n.remove=function(){o.points.length>1?J(o.points,G.position):(E.remove(o.line),J(O,o))},function(e,t,n){const o=e.indexOf(t);e.splice(o,0,n)}(o.points,i.position,n.position),o.redraw(),G.attach(n),E.add(G),C=n}!function(){for(const e of X)V(e)}(),window.overlay.insertAdjacentHTML("afterbegin",'\n\t<label><input type="radio" name="mode" value="none" /> None</label><br />\n\t<label><input type="radio" name="mode" value="item1" /> Place Lily Pad 1</label><br />\n\t<label><input type="radio" name="mode" value="item2" /> Place Lily Pad 2</label><br />\n\t<label><input type="radio" name="mode" value="curve" /> Curves</label>\n\t<section>\n\t\t<h2>Curve Actions</h2>\n\t\t<button id="curvecreate">Create New Curve</button>\n\t\t<button id="addhandle">Add Handle</button>\n\t\t<button id="curvedeletehandle">Delete Handle</button>\n\t\t<button id="updatefish">Update Fish</button>\n\t</section>\n\t<button id="consolelog">Console Log Data</button>\n'),window.addhandle.addEventListener("click",(()=>{K()})),window.consolelog.addEventListener("click",(function(){console.log(O.map((e=>e.points))),console.log("const lilypad1Positions = ",L.map((e=>e.position))),console.log("const lilypad2Positions = ",q.map((e=>e.position)))})),window.curvedeletehandle.addEventListener("click",(function(){window.overlay.querySelector('[value="curve"]').click(),C.remove(),F.redraw(),C.parent.remove(C),J(H,C),E.remove(G)})),window.curvecreate.addEventListener("click",(async function(){window.overlay.querySelector('[value="curve"]').click();const e=[await new Promise((e=>D.push(e)))],{curve:t,handles:n}=V(e);G.attach(n[0]),E.add(G),F=t,C=n[0]})),window.overlay.addEventListener("change",(function(e){"mode"===e.target.name&&(T=e.target.value)})),window.overlay.querySelector('[value="item1"]').click(),Y.then((function({trees:e}){setTimeout((()=>E.remove(e)),2e3)})),Z.add((async function(){if("none"===T||!W)return;const e=W;if(W=!1,U.setFromCamera(B,S),"select"===e){const e=N[T],t=U.intersectObjects(e);if(!t.length)return;const n=t[0].object;G.attach(n),E.add(G),C=!1,n.curve&&(F=n.curve,C=n)}if("curve"===T&&"add"===e){const e=U.intersectObjects([I]);if(!e.length)return;e[0].point.y=0,D.length?D.shift()(e[0].point):K(e[0].point)}if("item1"===T&&"add"===e){const e=U.intersectObjects([I]);if(!e.length)return;const{lilyPad1:t}=await Y,n=t.children[4].clone();n.position.x=e[0].point.x,n.position.z=e[0].point.z,L.push(n),I.add(n),G.attach(n),E.add(G)}if("item2"===T&&"add"===e){const e=U.intersectObjects([I]);if(!e.length)return;const{lilyPad2:t}=await Y,n=t.children[2].clone();n.position.x=e[0].point.x,n.position.z=e[0].point.z,q.push(n),I.add(n),G.attach(n),E.add(G)}})),j.domElement.addEventListener("click",(function(e){W="select",B.x=e.clientX/window.innerWidth*2-1,B.y=-e.clientY/window.innerHeight*2+1}),!1),j.domElement.addEventListener("dblclick",(function(e){W="add",B.x=e.clientX/window.innerWidth*2-1,B.y=-e.clientY/window.innerHeight*2+1}),!1);
//# sourceMappingURL=editor-a45c0dd2.js.map
